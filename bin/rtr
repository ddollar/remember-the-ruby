#!/usr/bin/env ruby

require 'pp'

require File.expand_path(File.join(
  File.dirname(__FILE__), 
  '..', 
  'lib', 
  'remember-the-ruby'
))
    
storage = RememberTheRuby::Storage.new

api = RememberTheRuby::API.new(:frob  => storage[:frob], 
                               :token => storage[:token])

unless storage[:frob]
  system %{open "#{api.authorization_url}"}
  storage[:frob] = api.frob
  exit
end

unless storage[:token]
  storage[:token] = api.authenticate
end

# pp api

# pp api.tasks

# task_id = api.tasks.first['id']
# pp api.tasks.find(task_id.to_i)
# pp api.tasks.find(task_id.to_s)

# pp api.tags
# pp api.tags.first.tasks.first.tags.first.tasks.first

# pp api.lists.find('id' => api.settings['defaultlist']).first.tasks

# pp api.lists[0].tasks.new